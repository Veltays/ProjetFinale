<Page x:Class="ProjetFinale.WPF.ExportsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="ExportsPage" 
      Background="#303030">

    <ScrollViewer Margin="20" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <StackPanel>
            <!-- En-tête de la page -->
            <StackPanel Style="{StaticResource ExportsHeaderStyle}">
                <TextBlock Text="EXPORTS" Style="{StaticResource ExportsMainTitleStyle}"/>
                <TextBlock Text="Exportez vos données dans différents formats" Style="{StaticResource ExportsSubtitleStyle}"/>
            </StackPanel>

            <!-- Section statistiques utilisateur avec data binding -->
            <Border Style="{StaticResource ExportsStatsCardStyle}">
                <StackPanel>
                    <TextBlock Text="📊 APERÇU DES DONNÉES À EXPORTER" Style="{StaticResource ExportsStatsTitleStyle}"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*"/>
                            <ColumnDefinition Width="1*"/>
                            <ColumnDefinition Width="1*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Infos utilisateur -->
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="👤 UTILISATEUR" Style="{StaticResource ExportsStatsHeaderStyle}"/>
                            <TextBlock Text="{Binding Pseudo, StringFormat='Pseudo : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding AgeFormate, StringFormat='Âge : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding PoidsFormate, StringFormat='Poids : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding TailleFormatee, StringFormat='Taille : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                        </StackPanel>

                        <!-- Données à exporter -->
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="📈 DONNÉES" Style="{StaticResource ExportsStatsHeaderStyle}"/>
                            <TextBlock Text="{Binding ListeTaches.Count, StringFormat='Tâches : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding ListeActivites.Count, StringFormat='Activités : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding ListeAgenda.Count, StringFormat='Agenda : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding ListeStatistiques.Count, StringFormat='Stats : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                        </StackPanel>

                        <!-- Objectifs -->
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="🎯 OBJECTIFS" Style="{StaticResource ExportsStatsHeaderStyle}"/>
                            <TextBlock Text="{Binding ObjectifPoidsFormate, StringFormat='Objectif : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding IMCFormate, StringFormat='IMC actuel : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding IMCObjectifFormate, StringFormat='IMC objectif : {0}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                            <TextBlock Text="{Binding DateObjectif, StringFormat='Échéance : {0:dd/MM/yyyy}'}" Style="{StaticResource ExportsStatsValueStyle}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Formats d'export disponibles -->
            <TextBlock Text="FORMATS D'EXPORT DISPONIBLES" Style="{StaticResource ExportsSectionTitleStyle}"/>

            <!-- Cartes des formats d'export -->
            <StackPanel Style="{StaticResource ExportsCardsContainerStyle}">

                <!-- CSV Export -->
                <Border Style="{StaticResource ExportsCardStyle}">
                    <StackPanel>
                        <!-- Icône CSV -->
                        <Border Style="{StaticResource ExportsIconGreenStyle}">
                            <TextBlock Text="📊" Style="{StaticResource ExportsIconTextStyle}"/>
                        </Border>

                        <!-- Titre et description -->
                        <TextBlock Text="CSV (.csv)" Style="{StaticResource ExportsCardTitleStyle}"/>
                        <TextBlock Text="Format de données séparées par des virgules. Compatible avec Excel, Google Sheets et la plupart des outils d'analyse." 
                                   Style="{StaticResource ExportsCardDescriptionStyle}"/>
                        <TextBlock Text="TAILLE: ~850 KB" Style="{StaticResource ExportsCardSizeGreenStyle}"/>

                        <!-- Bouton export -->
                        <Button Content="EXPORTER EN CSV"
                                Style="{StaticResource ExportsButtonStyle}"
                                Click="ExportCSV_Click"/>
                    </StackPanel>
                </Border>

                <!-- JSON Export -->
                <Border Style="{StaticResource ExportsCardStyle}">
                    <StackPanel>
                        <!-- Icône JSON -->
                        <Border Style="{StaticResource ExportsIconOrangeStyle}">
                            <TextBlock Text="📋" Style="{StaticResource ExportsIconTextStyle}"/>
                        </Border>

                        <!-- Titre et description -->
                        <TextBlock Text="JSON (.json)" Style="{StaticResource ExportsCardTitleStyle}"/>
                        <TextBlock Text="Format universel pour l'intégration avec d'autres applications ou pour les développeurs."
                                   Style="{StaticResource ExportsCardDescriptionStyle}"/>
                        <TextBlock Text="TAILLE: ~1.8 MB" Style="{StaticResource ExportsCardSizeOrangeStyle}"/>

                        <!-- Bouton export -->
                        <Button Content="EXPORTER EN JSON"
                                Style="{StaticResource ExportsButtonStyle}"
                                Click="ExportJSON_Click"/>
                    </StackPanel>
                </Border>

                <!-- XML Export -->
                <Border Style="{StaticResource ExportsCardStyle}">
                    <StackPanel>
                        <!-- Icône XML -->
                        <Border Style="{StaticResource ExportsIconBlueStyle}">
                            <TextBlock Text="💾" Style="{StaticResource ExportsIconTextStyle}"/>
                        </Border>

                        <!-- Titre et description -->
                        <TextBlock Text="XML (.xml)" Style="{StaticResource ExportsCardTitleStyle}"/>
                        <TextBlock Text="Format XML structuré pour la sauvegarde et restauration de toutes vos données."
                                   Style="{StaticResource ExportsCardDescriptionStyle}"/>
                        <TextBlock Text="TAILLE: ~900 KB" Style="{StaticResource ExportsCardSizeBlueStyle}"/>

                        <!-- Bouton export -->
                        <Button Content="EXPORTER EN XML"
                                Style="{StaticResource ExportsButtonStyle}"
                                Click="ExportSerialize_Click"/>
                    </StackPanel>
                </Border>

            </StackPanel>

            <!-- Section Export Complet -->
            <TextBlock Text="EXPORT COMPLET" Style="{StaticResource ExportsSectionTitleStyle}"/>

            <!-- Carte Export Tout -->
            <Border Style="{StaticResource ExportsCompleteCardStyle}">
                <StackPanel>
                    <TextBlock Text="EXPORTER TOUT" Style="{StaticResource ExportsCompleteTitleStyle}"/>
                    <TextBlock Text="Téléchargez toutes vos données dans tous les formats disponibles en une seule fois"
                               Style="{StaticResource ExportsCompleteDescriptionStyle}"/>

                    <!-- Affichage dynamique du total d'éléments -->
                    <TextBlock Style="{StaticResource ExportsCompleteSummaryStyle}">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}📊 {0} tâches • 🏃 {1} activités • 📅 {2} événements">
                                <Binding Path="ListeTaches.Count"/>
                                <Binding Path="ListeActivites.Count"/>
                                <Binding Path="ListeAgenda.Count"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>

                    <!-- Boutons alignés -->
                    <StackPanel Style="{StaticResource ExportsCompleteButtonsStyle}">
                        <Button Content="EXPORTER TOUT (.zip)"
                                Style="{StaticResource ExportsBigButtonStyle}"
                                Click="ExportAll_Click"/>

                        <Button Content="PROGRAMMER EXPORT"
                                Style="{StaticResource ExportsSecondaryButtonStyle}"
                                Click="ScheduleExport_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</Page>